import{d as k,X as g,Y as $,a5 as d,cc as ke,ci as Pe,cj as ee,ck as oe,cl as ye,cm as $e,cn as Ce,co as be,r as P,j as U,ae as Y,W as R,h as p,a8 as I,a_ as G,cp as Z,cq as xe,cr as Se,Z as v,_ as E,a3 as _,a4 as w,ab as Ge,a2 as Me,ce as te,cs as De,ct as se,cu as Ae,cv as Ie,cw as Re,a0 as ue,a1 as H,cx as Ee,cy as z,cz as N,cA as fe,cB as Be,cC as Oe,cD as Te,cE as D,cF as ze,cG as je,cH as Fe,cI as Ue,cJ as Ne,af as B,a6 as y,c9 as O,cK as pe,ca as Le,cL as _e,cM as We,w as Ye}from"./index.6e57c2f1.js";import{_ as V}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as j}from"./Space.2af8f31d.js";import{_ as He}from"./InputNumber.7f06f099.js";import{_ as Ve}from"./FormItem.5b33b5bf.js";import{_ as he}from"./Select.cca7837d.js";import{_ as qe}from"./Input.bebd1abf.js";import{_ as Ke,a as Xe}from"./Grid.aa914ce4.js";import{c as Je}from"./chrome-icon.de460a19.js";import{f as Ze}from"./firefox-icon.a50947ef.js";import{c as Qe}from"./helpers.34775daf.js";import{v as eo}from"./validate.5eb70dfd.js";import{I as oo}from"./IosMore.7ba500b7.js";import{_ as to}from"./Dropdown.fdbd6883.js";const so={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},no=d("path",{d:"M336 64h32a48 48 0 0 1 48 48v320a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V112a48 48 0 0 1 48-48h32",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),lo=d("rect",{x:"176",y:"32",width:"160",height:"64",rx:"26.13",ry:"26.13",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),ro=[no,lo],ne=k({name:"ClipboardOutline",render:function(o,t){return g(),$("svg",so,ro)}}),ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},io=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),co=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),uo=[io,co],Kt=k({name:"CloseOutline",render:function(o,t){return g(),$("svg",ao,uo)}}),fo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},po=d("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),_o=d("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ho=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M296 216v160"},null,-1),mo=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M376 296H216"},null,-1),wo=[po,_o,ho,mo],go=k({name:"DuplicateOutline",render:function(o,t){return g(),$("svg",fo,wo)}}),vo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ko=d("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Po=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1),yo=[ko,Po],le=k({name:"FolderOutline",render:function(o,t){return g(),$("svg",vo,yo)}}),$o={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Co=d("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),bo=[Co],xo=k({name:"PlayOutline",render:function(o,t){return g(),$("svg",$o,bo)}}),So={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Go=ke('<circle cx="128" cy="256" r="48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="384" cy="112" r="48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="384" cy="400" r="48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M169.83 279.53l172.34 96.94"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M342.17 135.53l-172.34 96.94"></path>',5),Mo=[Go],Do=k({name:"ShareSocialOutline",render:function(o,t){return g(),$("svg",So,Mo)}}),Ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Io=d("path",{d:"M392 432H120a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h272a40 40 0 0 1 40 40v272a40 40 0 0 1-40 40z",fill:"currentColor"},null,-1),Ro=[Io],Eo=k({name:"Stop",render:function(o,t){return g(),$("svg",Ao,Ro)}}),Bo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Oo=d("path",{d:"M434.67 285.59v-29.8c0-98.73-80.24-178.79-179.2-178.79a179 179 0 0 0-140.14 67.36m-38.53 82v29.8C76.8 355 157 435 256 435a180.45 180.45 0 0 0 140-66.92",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),To=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 256l44-44l46 44"},null,-1),zo=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M480 256l-44 44l-46-44"},null,-1),jo=[Oo,To,zo],Fo=k({name:"Sync",render:function(o,t){return g(),$("svg",Bo,jo)}}),Uo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 640 512"},No=d("path",{d:"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32S80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96s-96 43-96 96s43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4c24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48c0-61.9-50.1-112-112-112z",fill:"currentColor"},null,-1),Lo=[No],Wo=k({name:"UserFriends",render:function(o,t){return g(),$("svg",Uo,Lo)}}),Yo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ho=d("g",{fill:"none"},[d("path",{d:"M6 9a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm4 2a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm3 3a1 1 0 1 1-2 0a1 1 0 0 1 2 0zm-6 0a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm3-12a8 8 0 1 0 7.87 6.56a.5.5 0 0 0-.867-.24A2 2 0 0 1 13.5 7a.562.562 0 0 0-.44-.548a2 2 0 0 1-.954-3.386a.5.5 0 0 0-.232-.845A8.02 8.02 0 0 0 10 2zm-7 8a7 7 0 0 1 7.871-6.946a3 3 0 0 0 1.647 4.282a3 3 0 0 0 4.471 2.269A7 7 0 1 1 3 10z",fill:"currentColor"})],-1),Vo=[Ho],qo=k({name:"Cookies20Regular",render:function(o,t){return g(),$("svg",Yo,Vo)}}),Q=Pe("profileGroup",{state:()=>({list:[],profileGroup:{id:0,name:"",profiles:[]}}),getters:{profilesAssigned:e=>[...new Set(e.list.map(t=>t.profiles).filter(Boolean).flat())]},actions:{async getProfileGroups(){for(const[t,s]of this.$state.list.entries())if(eo(s.id)){const i=await ee(s.name),{data:{id:r}}=i.data;await oe(s.profiles,r),this.$state.list.splice(t,1)}const e=await ye(),{data:{profile_groups:o}}=e.data;this.$state.list=o},async createProfileGroup(e){try{return await ee(e),await this.getProfileGroups(),!0}catch{return!1}},async updateProfileGroup(e,o){try{return await $e(e,o),await this.getProfileGroups(),!0}catch{return!1}},async deleteProfilesGroup(e){await Ce(e),await this.getProfileGroups()},async addProfileToGroup(e,o){await oe(e,o)},async removeProfileFromGroup(e,o){await be(e,o)},async setProfileGroup(e){this.$patch(o=>{o.profileGroup=Object.assign({},e)})},async resetProfileGroupState(){this.$patch(e=>{e.profileGroup={id:0,name:"",profiles:[]}})}}}),re=Y({showCreateGroupModal:!1,showUpdateGroupModal:!1,showDeleteGroupModal:!1}),F=Q(),{list:ae,profileGroup:Ko}=R(F),L=P(null),ie=P([]),K=P(!1),me=()=>{const e=c=>({style:"cursor: pointer;",onClick:async()=>{F.setProfileGroup(c),L.value={...c},await r(c.id)}}),o=[{title:"Name",key:"name"},{title:"Profiles",key:"profiles.length"},{title:"Actions",ellipsis:!0,fixed:"right",width:"200",render:()=>p(j,null,{default:()=>[p(I,{ghost:!0,type:"error",size:"small",onClick:()=>re.showDeleteGroupModal=!0},{default:()=>"Delete",icon:()=>p(G,null,{default:()=>p(Z)})})]})}],t=P(""),s=U(()=>ae.value.filter(c=>c.name.includes(t.value))),i=async()=>await F.getProfileGroups(),r=async c=>{try{K.value=!0;const u=await xe(c),{data:{lst_profile:n}}=u.data;ie.value=n}catch(u){console.log("getProfilesInGroup ~ error",u)}finally{K.value=!1}};return{showModals:re,rowProps:e,groupColumns:o,profileGroups:ae,profileGroup:Ko,seletedGroup:L,keywordSearch:t,searchResults:s,profiles:ie,loadingProfiles:K,getProfileGroups:i,removeProfileFromGroup:async c=>{await F.removeProfileFromGroup([c].flat(),L.value.id),await r(L.value.id),await F.getProfileGroups()},confirmRemoveProfilesFromGroup:async()=>{}}},Xo={name:"ProfilesTableAction"},Jo=k({...Xo,props:{dropDownActions:{type:Array,defualt:()=>[]},onSelect:{type:Function,default:()=>{}},trigger:{type:String,default:"click"}},setup(e){const o=e,t=U(()=>Se(o.dropDownActions)||[]);return(s,i)=>{const r=G,a=to;return e.dropDownActions&&v(t).length?(g(),E(a,{key:0,trigger:e.trigger,options:v(t),onSelect:e.onSelect},{default:_(()=>[w(r,{class:"ml-10",size:"20"},{default:_(()=>[w(v(oo))]),_:1})]),_:1},8,["trigger","options","onSelect"])):Ge("",!0)}}}),Zo=ue(),{planExpired:ce,user:X}=R(Zo),M=H(),{list:Qo}=R(M),{seletedGroup:de,getProfileGroups:we}=me(),J=P(),W=P([]),x=P(new Set),b=Y({cloneProfile:!1,assignProfile:!1,assignBulkProfiles:!1,removeProfileFromGroup:!1,deleteProfile:!1,deleteBulkProfiles:!1,exportProfile:!1,shareProfile:!1,shareOnCloud:!1,shareBulkProfilesOnCloud:!1,stopShareBulkProfilesOnCloud:!1}),C=(e,o=null)=>()=>p(G,o,{default:()=>p(e)}),A=P(new Set),ge=async e=>{const{id:o,filename:t,permission:s}=e;try{if(t&&(s===D.READ||s===D.READ_WRITE))try{x.value.add(o);const l=await ze(e);x.value.delete(o)}catch{}finally{x.value.delete(o)}A.value.add(o);const i=await je(o),{success:r,data:a}=i.data;if(r){const l=await Fe(a,o),{success:c,error:u}=l;c?M.updateProfileStatus(o,z.RUNNING):console.log(u)}}catch{}finally{A.value.delete(o)}},ve=async e=>{try{A.value.add(e);const o=await Ue(e);M.updateProfileStatus(e,z.READY),x.value.delete(e)}catch{}finally{const o=await N(e),{data:t}=o.data,{permission:s,filename:i}=t;i&&s===D.READ_WRITE&&(await fe(t),x.value.delete(e)),A.value.delete(e)}},et=Ne();et.on(Ee.PROFILE_STOPPED,async e=>{const{id:o,code:t}=e;t===0?M.updateProfileStatus(o,z.READY):M.updateProfileStatus(o,z.READY);const s=await N(o),{data:i}=s.data,{filename:r}=i;r&&(x.value.add(o),await fe(i),x.value.delete(o))});const T=()=>{const{localProfileList:e,startedProfileList:o,readyProfileList:t}=R(M),s=n=>({style:"cursor: pointer;",onClick:()=>{J.value={...n}}}),i=U(()=>[{type:"selection",options:["all","none",{label:"Select local profile",key:"f2",onSelect:()=>{W.value=[...e.value]}},{label:"Select profile not running",key:"f3",onSelect:()=>{W.value=[...t.value]}}]},{title:"Name",key:"name",width:"200",render(n){const{browser:f,name:m}=n.profile_data;return p("div",[p("img",{class:"mr-2 inline-block",src:f===Me.CHROME?Je:Ze,width:"24"}),m])}},{title:"Status",key:"status",width:"100",render(n){const{id:f,status:m}=n,h=()=>{if(x.value.has(f))return p("span",null,"Syncing");if(m===z.READY)return p("span",null,"Ready");if(m===z.RUNNING)return p("span",null,"Running")};return p(j,null,{default:()=>h()})}},{title:"Proxy",key:"profile_data.proxy.type",width:"100",render(n){try{const f=Object.values(te).find(m=>m.value===n.profile_data.proxy.type);return p("span",{},f.label)}catch{return p("span",{},te.WITHOUT)}}},{title:"Last updated",key:"updated_at",width:"200",render(n){const{updated_at:f,filename:m,user_id:h}=n,S=De(f);return p("div",[S.format("DD/MM/YYYY"),...m?[p(G,{size:"24",class:"ml-2",color:"#55b3e6"},{default:()=>p(se)}),...X.value.id!==h?[p(G,{size:"24",class:"ml-2",color:"#55b3e6"},{default:()=>p(Wo)})]:[]]:[]])}},{key:"actions",ellipsis:!0,fixed:"right",width:"200",render(n){const{id:f,filename:m}=n,h=Boolean(m);return p("div",[(()=>x.value.has(f)?[p(I,{id:"syncBtn",type:"success",disabled:x.value.has(f),loading:x.value.has(f)},{default:()=>"Syncing",icon:()=>p(G,null,{default:()=>p(Fo)})})]:[...o.value.includes(f)?[p(I,{type:"error",onClick:()=>a(n),disabled:A.value.has(n.id),loading:A.value.has(n.id)},{default:()=>"Stop",icon:()=>p(G,null,{default:()=>p(Eo)})})]:[p(I,{type:"primary",onClick:()=>r(n),disabled:A.value.has(n.id),loading:A.value.has(n.id)},{default:()=>"Start",icon:()=>p(G,null,{default:()=>p(xo)})})]])(),p(Jo,{trigger:"hover",dropDownActions:[{label:"Edit",key:"edit",icon:C(Be)},...de.value&&de.value.id?[{label:"Remove from group",key:"removeFromGroup",icon:C(le,{color:"red"})}]:[{label:"Assign to group",key:"assignToGroup",icon:C(le)}],{label:"Clone",key:"clone",icon:C(go)},{type:"divider",key:"d1"},{label:"Sharing",key:"sharing",icon:C(Do)},{label:"Export Cookies",key:"exportCookies",icon:C(qo)},{label:h?"Stop share on cloud":"Share on cloud",key:"shareOnCloud",icon:C(h?Oe:se)},{label:"Copy ID",key:"copyId",icon:C(ne)},...o.value.includes(f)?[{label:"Copy WsEndpoint",key:"copyWsEndpoint",icon:C(ne)}]:[],{type:"divider",key:"d1"},{label:"Delete",key:"delete",icon:C(Z,{color:"red"})}],onSelect:async q=>{switch(J.value=n,q){case"edit":M.setEditProfile(n);break;case"assignToGroup":b.assignProfile=!0,await we();break;case"removeFromGroup":b.removeProfileFromGroup=!0;break;case"clone":b.cloneProfile=!0;break;case"sharing":b.shareProfile=!0;break;case"shareOnCloud":b.shareOnCloud=!0;break;case"export":l(n);break;case"exportCookies":c(n);break;case"copyId":await Qe(n);break;case"copyWsEndpoint":await u(n);break;case"delete":b.deleteProfile=!0;break}}})])}}]),r=async n=>{try{const{id:f,user_id:m}=n;if(ce.value&&X.value.id===m){window.$message.warning("Plan expired");return}const h=await N(f),{data:S}=h.data;await ge(S)}catch{}},a=async n=>{try{const{id:f,user_id:m}=n;if(ce.value&&X.value.id===m){window.$message.warning("Plan expired");return}await ve(f)}catch{}},l=async n=>{await Ae(n)},c=async n=>{await Ie(n)||window.$message.warning("Profile cookies not found")},u=async n=>{try{const{id:f}=n,m=await Re(f),{success:h,data:S}=m.data;h?(await navigator.clipboard.writeText(S.wsEndpoint),window.$message.success("Ws Endpoint copied")):window.$message.warning("Profile not started")}catch{}};return{showModals:b,rowProps:s,profileColumns:i,selectedProfile:J,selectedProfiles:W}},ot=()=>{const{readyProfileList:e,startedProfileList:o}=R(M),t=[{label:"Delete",icon(){return p(G,{color:"red"},{default:()=>p(Z)})},key:"bulk.deleteProfiles"}],s=W,i=()=>{s.value=[]},r=async()=>{const m=e.value.filter(h=>s.value.includes(h));await Promise.all(m.map(async h=>{const S=await N(h),{data:q}=S.data;return ge(q)}))},a=async()=>{const m=o.value.filter(h=>s.value.includes(h));await Promise.all(m.map(h=>ve(h)))},l=async m=>{switch(m){case"bulk.deleteProfiles":b.deleteBulkProfiles=!0;break}},c=async()=>{b.assignBulkProfiles=!0,await we()},u=()=>{b.shareBulkProfilesOnCloud=!0},n=()=>{b.stopShareBulkProfilesOnCloud=!0},f=async()=>{const m=s.value.map(h=>Qo.value.find(S=>S.id===h));await M.newFingerpint(m)};return Te(()=>{s.value=[]}),{bulkMoreActions:t,checkedRowKeys:s,cancelBulk:i,startBulkProfiles:r,stopBulkProfiles:a,handleSelectBulkMore:l,assignProfilesToGroup:c,shareProfilesOnCloud:u,stopShareProfilesOnCloud:n,newFingerPrint:f}},tt=y(" Removing profile "),st={class:"font-700"},nt=y(" from group: "),lt={class:"font-700"},Xt=k({__name:"RemoveProfileFromGroupModal",setup(e){Q();const{seletedGroup:o,removeProfileFromGroup:t}=me(),{showModals:s,selectedProfile:i}=T(),r=P(null);o&&(r.value=o);const a=async()=>{try{window.$message.loading("Removing...");const{id:l}=i.value;await t(l),window.$message.info("Profile removed")}catch{window.$message.info("Profile remove failed")}finally{window.$message.destroyAll()}};return(l,c)=>{const u=O;return g(),E(u,{show:v(s).removeProfileFromGroup,"onUpdate:show":c[0]||(c[0]=n=>v(s).removeProfileFromGroup=n),preset:"dialog",title:"",content:"Are you sure?","positive-text":"Remove","negative-text":"Cancel",onPositiveClick:a},{header:_(()=>{var n,f;return[d("div",null,[tt,d("span",st,B((n=v(i))==null?void 0:n.profile_data.name),1),nt,d("span",lt,B((f=r.value)==null?void 0:f.name),1)])]}),_:1},8,["show"])}}}),rt={name:"DeleteProfileModal",setup:()=>{const e=pe(),{showModals:o,selectedProfile:t}=T(),s=H(),i=P(!1),r=()=>{o.deleteProfile=!1};return{profile:t,submitted:i,showModals:o,closeModal:r,handleDeleteProfile:async()=>{try{i.value=!0,e.loading("Deleting...");const{id:l}=t.value;await s.deleteProfile(l),e.info("Profile deleted successfully"),r()}catch{e.info("Delete profile failed")}finally{i.value=!1,e.destroyAll()}}}}},at=y(" Delete profile: "),it={class:"font-700"},ct=y(" Cancel "),dt=y(" Delete ");function ut(e,o,t,s,i,r){const a=I,l=j,c=O;return g(),E(c,{show:e.showModals.deleteProfile,"onUpdate:show":o[0]||(o[0]=u=>e.showModals.deleteProfile=u),preset:"dialog",title:"",content:"Are you sure?"},{header:_(()=>[d("div",null,[at,d("span",it,B(e.profile.profile_data.name),1)])]),action:_(()=>[w(l,null,{default:_(()=>[w(a,{size:"small",disabled:e.submitted,onClick:e.closeModal},{default:_(()=>[ct]),_:1},8,["disabled","onClick"]),w(a,{size:"small",type:"error",disabled:e.submitted,loading:e.submitted,onClick:e.handleDeleteProfile},{default:_(()=>[dt]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1},8,["show"])}const Jt=V(rt,[["render",ut]]),ft={name:"DeleteProfileModal",setup:()=>{const e=pe(),{showModals:o}=T(),{checkedRowKeys:t}=ot(),s=H(),i=P(!1),r=()=>{o.deleteBulkProfiles=!1};return{showModals:o,submitted:i,handleDeleteProfile:async()=>{try{i.value=!0,e.loading("Deleting...");const l=t.value;await s.deleteBulkProfiles(l),t.value=[],e.info("Profile deleted successfully"),r()}catch{e.info("Delete profile failed")}finally{i.value=!1,e.destroyAll()}},closeModal:r}}},pt=y(" Are you sure to delete selected profiles? "),_t=y(" Cancel "),ht=y(" Delete ");function mt(e,o,t,s,i,r){const a=I,l=j,c=O;return g(),E(c,{show:e.showModals.deleteBulkProfiles,"onUpdate:show":o[0]||(o[0]=u=>e.showModals.deleteBulkProfiles=u),preset:"dialog",title:"",content:"Are you sure?"},{action:_(()=>[w(l,null,{default:_(()=>[w(a,{size:"small",disabled:e.submitted,onClick:e.closeModal},{default:_(()=>[_t]),_:1},8,["disabled","onClick"]),w(a,{size:"small",type:"error",disabled:e.submitted,loading:e.submitted,onClick:e.handleDeleteProfile},{default:_(()=>[ht]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:_(()=>[pt]),_:1},8,["show"])}const Zt=V(ft,[["render",mt]]),wt={name:"CloneProfileModal",setup:()=>{const{showModals:e,selectedProfile:o}=T(),t=ue(),s=H(),{profileLimit:i}=R(t),{list:r}=R(s),a=20,l=P(1),c=U(()=>i.value-r.value.length);return{selectedProfile:o,showModals:e,amountProfileCanClone:c,max:a,amountClone:l,handleCloneProfile:async()=>{if(l.value>a){window.$message.warning(`Only ${a} can clone at once`);return}e.cloneProfile=!1,await s.cloneProfile(o.value,l.value)}}}},gt=y(" Clone profile: "),vt={class:"font-700"},kt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},Pt=d("small",{class:"text-gray-400"},"Cookies and storages won't be copied",-1);function yt(e,o,t,s,i,r){const a=He,l=Ve,c=O;return g(),E(c,{show:e.showModals.cloneProfile,"onUpdate:show":o[1]||(o[1]=u=>e.showModals.cloneProfile=u),"transform-origin":"center",preset:"dialog",title:"","positive-text":"Clone","negative-text":"Cancel",onPositiveClick:e.handleCloneProfile},{header:_(()=>[d("div",null,[gt,d("span",vt,B(e.selectedProfile.profile_data.name),1)])]),default:_(()=>[d("div",kt,[w(l,{label:`Number of copies (Max ${e.max} at once)`,"show-feedback":!1},{default:_(()=>[w(a,{value:e.amountClone,"onUpdate:value":o[0]||(o[0]=u=>e.amountClone=u),placeholder:"",max:e.max},null,8,["value","max"])]),_:1},8,["label"]),Pt])]),_:1},8,["show","onPositiveClick"])}const Qt=V(wt,[["render",yt]]),$t={name:"ShareProfileModal",setup:()=>{const{showModals:e,selectedProfile:o}=T(),t=Y({targetInvite:"",selectedRight:D.READ,submitting:!1}),s=[{label:"Read",value:D.READ},{label:"Read + Write",value:D.READ_WRITE}],i=()=>{e.shareProfile=!1,t.targetInvite="",t.selectedRight=D.READ,t.submitting=!1},r=async()=>{if(!t.targetInvite){window.$message.warning("Target cannot be blank");return}try{t.submitting=!0;const{id:a}=o.value;await _e({id:a,share_status:!0});const l={id:a,user_email:t.targetInvite,user_permission:t.selectedRight.toString()},c=await We(l),{success:u}=c.data;u?(window.$message.success("User added"),e.shareProfile=!1,t.targetInvite="",t.selectedRight=D.READ,t.submitting=!1):window.$message.warning("User not found")}catch{}finally{t.submitting=!1}};return{selectedProfile:o,showModals:e,...Le(t),rights:s,closeModal:i,shareProfile:r}}};const Ct=y(" Share profile: "),bt={class:"font-700"},xt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},St=y(" Invite ");function Gt(e,o,t,s,i,r){const a=qe,l=Ke,c=he,u=I,n=Xe,f=j,m=O;return g(),E(m,{id:"share-modal",show:e.showModals.shareProfile,"onUpdate:show":o[2]||(o[2]=h=>e.showModals.shareProfile=h),"transform-origin":"center",preset:"dialog"},{header:_(()=>[d("div",null,[Ct,d("span",bt,B(e.selectedProfile.profile_data.name),1)])]),default:_(()=>[d("div",xt,[w(n,{"x-gap":"12",cols:8},{default:_(()=>[w(l,{span:"4"},{default:_(()=>[w(a,{value:e.targetInvite,"onUpdate:value":o[0]||(o[0]=h=>e.targetInvite=h),placeholder:"Invite someone..."},null,8,["value"])]),_:1}),w(l,{span:"2"},{default:_(()=>[w(c,{value:e.selectedRight,"onUpdate:value":o[1]||(o[1]=h=>e.selectedRight=h),options:e.rights,"consistent-menu-width":!1},null,8,["value","options"])]),_:1}),w(l,null,{default:_(()=>[w(u,{type:"primary",loading:e.submitting,onClick:e.shareProfile},{default:_(()=>[St]),_:1},8,["loading","onClick"])]),_:1})]),_:1}),w(f,{vertical:""})])]),_:1},8,["show"])}const es=V($t,[["render",Gt]]),Mt=d("div",null,"Assign to group",-1),Dt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},os=k({__name:"AssignProfileToGroupModal",setup(e){const{showModals:o,selectedProfile:t}=T(),s=Q(),{list:i}=R(s),r=P([]),a=U(()=>i.value.map((u,n)=>({label:u.name,value:u.id}))),l=()=>{r.value=[],o.assignProfile=!1},c=async()=>{try{window.$message.loading("Assigning..."),await Promise.allSettled(r.value.map(async u=>await s.addProfileToGroup([t.value.id],u))),window.$message.destroyAll(),window.$message.success("Profile assigned"),l()}catch{window.$message.info("Profile assign failed")}finally{window.$message.destroyAll()}};return(u,n)=>{const f=he,m=O;return g(),E(m,{id:"modal-assign-profiles",show:v(o).assignProfile,"onUpdate:show":n[1]||(n[1]=h=>v(o).assignProfile=h),"transform-origin":"center",preset:"dialog",title:"","positive-text":"Assign","negative-text":"Cancel","on-mask-click":l,onPositiveClick:c,onNegativeClick:l},{header:_(()=>[Mt]),default:_(()=>[d("div",Dt,[w(f,{value:r.value,"onUpdate:value":n[0]||(n[0]=h=>r.value=h),filterable:"",multiple:"",options:v(a)},null,8,["value","options"])])]),_:1},8,["show"])}}});const At={key:0},It={key:1},Rt={class:"font-700"},Et=y(" Cancel "),ts=k({__name:"ShareOnCloud",setup(e){const{showModals:o,selectedProfile:t}=T(),s=Y({status:!0,submitted:!1});Ye(()=>o.shareOnCloud,async()=>{s.status=!0;const{id:r}=t.value,a=await N(r),{data:l}=a.data;l.filename&&(s.status=!1)});const i=async()=>{try{s.submitted=!0,window.$message.loading("Sharing...");const{id:r}=t.value,a=await _e({id:r,share_status:s.status});s.status?window.$message.info("Profile shared on cloud"):window.$message.info("Profile stopped share on cloud")}catch{window.$message.info("Update share status failed")}finally{s.submitted=!1,window.$message.destroyAll(),o.shareOnCloud=!1}};return(r,a)=>{const l=j,c=I,u=O;return g(),E(u,{show:v(o).shareOnCloud,"onUpdate:show":a[1]||(a[1]=n=>v(o).shareOnCloud=n),preset:"dialog",content:"Are you sure?"},{header:_(()=>[d("div",null,[w(l,null,{default:_(()=>[s.status?(g(),$("span",At,"Share on cloud:")):(g(),$("span",It,"Stop share on cloud:")),d("span",Rt,B(v(t).profile_data.name),1)]),_:1})])]),action:_(()=>[w(l,null,{default:_(()=>[w(c,{size:"small",onClick:a[0]||(a[0]=n=>v(o).shareOnCloud=!v(o).shareOnCloud)},{default:_(()=>[Et]),_:1}),w(c,{size:"small",type:s.status?"primary":"error",loading:s.submitted,disabled:s.submitted,onClick:i},{default:_(()=>[y(B(s.status?"Share":"Stop"),1)]),_:1},8,["type","loading","disabled"])]),_:1})]),_:1},8,["show"])}}});export{le as A,Kt as C,Jt as D,xo as S,ts as _,ot as a,Q as b,Eo as c,Zt as d,Qt as e,es as f,os as g,Xt as h,me as i,T as u};
